-- MySQL Script generated by MySQL Workbench
-- Mon Jan  8 17:43:07 2018
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema argon
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `argon` ;

-- -----------------------------------------------------
-- Schema argon
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `argon` DEFAULT CHARACTER SET utf8 ;
USE `argon` ;

-- -----------------------------------------------------
-- Table `STATUSES`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `STATUSES` ;

CREATE TABLE IF NOT EXISTS `STATUSES` (
  `ID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `STATUS` VARCHAR(50) NOT NULL,
  `CREATED_AT` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `MODIFIED_AT` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`ID`),
  UNIQUE INDEX `STATUS_UNIQUE` (`STATUS` ASC))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `USERS`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `USERS` ;

CREATE TABLE IF NOT EXISTS `USERS` (
  `ID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `USERNAME` VARCHAR(50) NOT NULL,
  `PASSWORD` VARCHAR(100) NOT NULL,
  `FIRST_NAME` VARCHAR(50) NULL,
  `LAST_NAME` VARCHAR(50) NULL,
  `EMAIL` VARCHAR(100) NOT NULL,
  `ENABLED` TINYINT(1) NOT NULL DEFAULT 0,
  `VERIFIED` TINYINT(1) NOT NULL DEFAULT 0,
  `STATUS_ID` INT UNSIGNED NOT NULL,
  `DOB` DATE NOT NULL,
  `CREATED_AT` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `MODIFIED_AT` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`ID`),
  UNIQUE INDEX `USERNAME_UNIQUE` (`USERNAME` ASC),
  UNIQUE INDEX `EMAIL_UNIQUE` (`EMAIL` ASC),
  INDEX `fk_USERS_STATUSES1_idx` (`STATUS_ID` ASC),
  CONSTRAINT `fk_USERS_STATUSES1`
    FOREIGN KEY (`STATUS_ID`)
    REFERENCES `STATUSES` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `AUTHORITIES`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `AUTHORITIES` ;

CREATE TABLE IF NOT EXISTS `AUTHORITIES` (
  `ID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `AUTHORITY` VARCHAR(50) NOT NULL,
  `CREATED_AT` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `MODIFIED_AT` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`ID`),
  UNIQUE INDEX `AUTHORITY_UNIQUE` (`AUTHORITY` ASC))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `USER_AUTHORITIES`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `USER_AUTHORITIES` ;

CREATE TABLE IF NOT EXISTS `USER_AUTHORITIES` (
  `USER_ID` INT UNSIGNED NOT NULL,
  `AUTHORITY_ID` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`USER_ID`, `AUTHORITY_ID`),
  INDEX `fk_USERS_has_AUTHORITIES_AUTHORITIES1_idx` (`AUTHORITY_ID` ASC),
  INDEX `fk_USERS_has_AUTHORITIES_USERS_idx` (`USER_ID` ASC),
  CONSTRAINT `fk_USERS_has_AUTHORITIES_USERS`
    FOREIGN KEY (`USER_ID`)
    REFERENCES `USERS` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_USERS_has_AUTHORITIES_AUTHORITIES1`
    FOREIGN KEY (`AUTHORITY_ID`)
    REFERENCES `AUTHORITIES` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `CONFIRMATIONS`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `CONFIRMATIONS` ;

CREATE TABLE IF NOT EXISTS `CONFIRMATIONS` (
  `ID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `LINK` VARCHAR(250) NOT NULL,
  `ATTEMPTS` INT NOT NULL DEFAULT 3,
  `USER_ID` INT UNSIGNED NOT NULL,
  `CREATED_AT` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `MODIFIED_AT` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`ID`),
  UNIQUE INDEX `LINK_UNIQUE` (`LINK` ASC),
  INDEX `fk_CONFIRMATIONS_USERS1_idx` (`USER_ID` ASC),
  CONSTRAINT `fk_CONFIRMATIONS_USERS1`
    FOREIGN KEY (`USER_ID`)
    REFERENCES `USERS` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `CHATS`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `CHATS` ;

CREATE TABLE IF NOT EXISTS `CHATS` (
  `ID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `NAME` VARCHAR(255) NOT NULL,
   `OWNER_ID` INT UNSIGNED NOT NULL,
  `PRIVATE` TINYINT(1) NOT NULL DEFAULT 0,
  `CREATED_AT` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `MODIFIED_AT` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`ID`),
  UNIQUE INDEX `NAME_UNIQUE` (`NAME` ASC),
  INDEX `fk_CHATS_USERS1_idx` (`OWNER_ID` ASC),
  CONSTRAINT `fk_CHATS_USERS1`
    FOREIGN KEY (`OWNER_ID`)
    REFERENCES `USERS` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `MESSAGES`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `MESSAGES` ;

CREATE TABLE IF NOT EXISTS `MESSAGES` (
  `ID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `BODY` TEXT NOT NULL,
  `ATTACHMENT` BLOB NULL,
  `USER_ID` INT UNSIGNED NOT NULL,
  `CHAT_ID` INT UNSIGNED NOT NULL,
  `IS_READ` TINYINT(1) NULL DEFAULT 0,
  `CREATED_AT` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `MODIFIED_AT` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`ID`),
  INDEX `fk_MESSAGES_USERS1_idx` (`USER_ID` ASC),
  INDEX `fk_MESSAGES_CHATS1_idx` (`CHAT_ID` ASC),
  CONSTRAINT `fk_MESSAGES_USERS1`
    FOREIGN KEY (`USER_ID`)
    REFERENCES `USERS` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_MESSAGES_CHATS1`
    FOREIGN KEY (`CHAT_ID`)
    REFERENCES `CHATS` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `CHAT_USERS`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `CHAT_USERS` ;

CREATE TABLE IF NOT EXISTS `CHAT_USERS` (
  `CHATS_ID` INT UNSIGNED NOT NULL,
  `USERS_ID` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`CHATS_ID`, `USERS_ID`),
  INDEX `fk_CHATS_has_USERS_USERS1_idx` (`USERS_ID` ASC),
  INDEX `fk_CHATS_has_USERS_CHATS1_idx` (`CHATS_ID` ASC),
  CONSTRAINT `fk_CHATS_has_USERS_CHATS1`
    FOREIGN KEY (`CHATS_ID`)
    REFERENCES `CHATS` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_CHATS_has_USERS_USERS1`
    FOREIGN KEY (`USERS_ID`)
    REFERENCES `USERS` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `SETTINGS`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `SETTINGS` ;

CREATE TABLE IF NOT EXISTS `SETTINGS` (
  `ID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `SOUND_ENABLED` TINYINT(1) NOT NULL DEFAULT 1,
  `NEWS_ENABLED` TINYINT(1) NOT NULL DEFAULT 1,
  `USER_ID` INT UNSIGNED NOT NULL,
  `CREATED_AT` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `MODIFIED_AT` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`ID`),
  INDEX `fk_SETTINGS_USERS1_idx` (`USER_ID` ASC),
  CONSTRAINT `fk_SETTINGS_USERS1`
    FOREIGN KEY (`USER_ID`)
    REFERENCES `USERS` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `BLACKLIST`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `BLACKLIST` ;

CREATE TABLE IF NOT EXISTS `BLACKLIST` (
  `ID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `USER_ID` INT UNSIGNED NOT NULL,
  `CHAT_ID` INT UNSIGNED NOT NULL,
  `CREATED_AT` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `MODIFIED_AT` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`ID`),
  INDEX `fk_BLACKLIST_USERS1_idx` (`USER_ID` ASC),
  INDEX `fk_BLACKLIST_CHATS1_idx` (`CHAT_ID` ASC),
  CONSTRAINT `fk_BLACKLIST_USERS1`
    FOREIGN KEY (`USER_ID`)
    REFERENCES `USERS` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_BLACKLIST_CHATS1`
    FOREIGN KEY (`CHAT_ID`)
    REFERENCES `CHATS` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `RESET_PASSWORD`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `RESET_PASSWORD` ;

CREATE TABLE IF NOT EXISTS `RESET_PASSWORD` (
  `ID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `TOKEN` VARCHAR(250) NOT NULL,
  `NEW_PASSWORD` VARCHAR(100) NOT NULL,
  `USERS_ID` INT UNSIGNED NOT NULL,
  `CREATED_AT` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `MODIFIED_AT` TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`ID`),
  UNIQUE INDEX `ID_UNIQUE` (`ID` ASC),
  INDEX `fk_RESET_PASSWORD_USERS1_idx` (`USERS_ID` ASC),
  CONSTRAINT `fk_RESET_PASSWORD_USERS1`
    FOREIGN KEY (`USERS_ID`)
    REFERENCES `USERS` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
